# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ API –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è outtime.outcasts.dev

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞
API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç **HTTP 502: Bad Gateway** –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ `https://outtime.outcasts.dev/api/public/health`

**–ü—Ä–∏—á–∏–Ω–∞:** Backend —Å–µ—Ä–≤–µ—Ä –Ω–µ –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 3000

## ‚ö° –ë—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. **–ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É:**
   ```bash
   ssh your-username@outtime.outcasts.dev
   ```

2. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞:**
   ```bash
   cd /var/www/outtime.outcasts.dev/backend
   ```

3. **–°–æ–∑–¥–∞–π—Ç–µ .env —Ñ–∞–π–ª (–µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç):**
   ```bash
   cp env.example .env
   nano .env
   ```
   
   –í—Å—Ç–∞–≤—å—Ç–µ —ç—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
   ```env
   DATABASE_URL=postgresql://postgres:8p8m6FS9nAWl5hxq@db.eokcyeyucknztfzrrwmc.supabase.co:5432/postgres
   JWT_SECRET=YyKx7XjJ2r8wL!bFgV93TNnE^Z6Qv@pLwXbM9sD4uG^TkCzAqRhVt%JmXe5UzNd
   BOT_TOKEN=7702024149:AAEwYiA7qqhWkKIDpC-OQrfiHclX-sJ6gC4
   NODE_ENV=production
   PORT=3000
   FRONTEND_URL=https://outtime.outcasts.dev
   API_BASE_URL=https://outtime.outcasts.dev
   TIMEZONE=Europe/Moscow
   ```

4. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç:**
   ```bash
   ./start-production.sh
   ```

**–ì–æ—Ç–æ–≤–æ!** üéâ –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –ü—Ä–æ–≤–µ—Ä–∏—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–µ—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
- –ó–∞–ø—É—Å—Ç–∏—Ç —Å–µ—Ä–≤–µ—Ä
- –ü—Ä–æ–≤–µ—Ä–∏—Ç —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å

---

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–∞:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã –Ω–∞ –ø–æ—Ä—Ç—É 3000
sudo netstat -tlnp | grep :3000

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è PM2)
pm2 logs outtime-backend

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å health check –ª–æ–∫–∞–ª—å–Ω–æ
curl http://localhost:3000/api/public/health
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Nginx:
```bash
# –°—Ç–∞—Ç—É—Å Nginx
sudo systemctl status nginx

# –õ–æ–≥–∏ Nginx
sudo tail -f /var/log/nginx/error.log

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á–µ—Ä–µ–∑ Nginx
curl -I https://outtime.outcasts.dev/api/public/health
```

---

## üõ†Ô∏è –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ (–µ—Å–ª–∏ –∞–≤—Ç–æ—Å–∫—Ä–∏–ø—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)

### –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```bash
cd /var/www/outtime.outcasts.dev/backend
npm install
# –∏–ª–∏
pnpm install
```

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
```bash
node test-db.js
```

### –®–∞–≥ 3: –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä

**–í–∞—Ä–∏–∞–Ω—Ç A: –° PM2 (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å PM2 –µ—Å–ª–∏ –Ω–µ—Ç
npm install -g pm2

# –ó–∞–ø—É—Å—Ç–∏—Ç—å
pm2 start server.js --name "outtime-backend"
pm2 save
pm2 startup

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
pm2 status
```

**–í–∞—Ä–∏–∞–Ω—Ç B: –í —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ**
```bash
nohup node server.js > server.log 2>&1 &
echo $! > server.pid
```

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É
```bash
curl http://localhost:3000/api/public/health
```

---

## ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### üÜï –ù–æ–≤—ã–π —Ñ–∞–π–ª: `backend/start-production.sh`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ PM2
- –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### Frontend –∏–∑–º–µ–Ω–µ–Ω–∏—è:
- **api.js** - —É–º–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ API URL –¥–ª—è production
- **ComponentsTest.jsx** - —Ç–µ—Å—Ç API –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- **Header.jsx** - ThemeToggle –∏ —É–ª—É—á—à–µ–Ω–Ω—ã–π –¥–∏–∑–∞–π–Ω  
- **Layout.jsx** - Breadcrumbs –Ω–∞–≤–∏–≥–∞—Ü–∏—è
- **Sidebar.jsx** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–µ–º–Ω–æ–π —Ç–µ–º—ã

### Backend –∏–∑–º–µ–Ω–µ–Ω–∏—è:
- **app.js** - CORS –¥–ª—è outtime.outcasts.dev
- **routes/public.js** - health check endpoint
- **test-db.js** - —Ç–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î

### Nginx –∏–∑–º–µ–Ω–µ–Ω–∏—è:
- **nginx.conf** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è outtime.outcasts.dev
- CORS –∑–∞–≥–æ–ª–æ–≤–∫–∏ –¥–ª—è API
- –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –∫ localhost:3000

---

## üöÄ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ backend —Å–µ—Ä–≤–µ—Ä–∞:
- ‚úÖ `curl https://outtime.outcasts.dev/api/public/health` –≤–µ—Ä–Ω–µ—Ç HTTP 200
- ‚úÖ –¢–µ—Å—Ç API –≤ UI –ø–æ–∫–∞–∂–µ—Ç "–ü–æ–¥–∫–ª—é—á–µ–Ω–æ"
- ‚úÖ –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∑–∞—Ä–∞–±–æ—Ç–∞—é—Ç

## ‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **–ü–æ—Ä—Ç 3000 –∑–∞–Ω—è—Ç:** –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≤–µ—Ä—à–∏—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å
2. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ DATABASE_URL –≤ .env
3. **PM2 –Ω–µ –Ω–∞–π–¥–µ–Ω:** –°–∫—Ä–∏–ø—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –±–µ–∑ PM2
4. **–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:** –ó–∞–ø—É—Å–∫–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä—ã–π –≤–ª–∞–¥–µ–µ—Ç —Ñ–∞–π–ª–∞–º–∏

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã –æ—Å—Ç–∞—é—Ç—Å—è:
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ: `./start-production.sh`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `pm2 logs outtime-backend`
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ .env —Ñ–∞–π–ª —Å–æ–∑–¥–∞–Ω —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ 